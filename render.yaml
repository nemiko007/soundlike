services:
  # --- バックエンドサービス (Go) ---
  - type: web
    name: backend
    env: docker
    # Dockerfileがある場所を指定
    dockerfilePath: ./backend/Dockerfile
    dockerContext: ./backend
    # ディスクの設定
    disks:
      # soundlike.db を永続化するためのディスク
      - name: soundlike-db
        mountPath: /var/lib/soundlike
        sizeGB: 1 # 1GBで十分
      # アップロードされたファイルを永続化するためのディスク
      - name: uploads
        mountPath: /root/uploads
        sizeGB: 1
    secretFiles: # FirebaseのサービスアカウントキーをSecret Fileとしてマウント
      - name: firebase-service-account-key
        key: firebase-service-account-key.json
        mountPath: /root/firebase-service-account-key.json
  # --- フロントエンドサービス (Nginx) ---
  - type: web
    name: frontend
    env: docker
    # Dockerfileがある場所を指定
    dockerfilePath: ./frontend/Dockerfile
    dockerContext: ./frontend